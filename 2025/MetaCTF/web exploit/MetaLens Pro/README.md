# 『MetaLens Pro』

<img width="1384" height="397" alt="image" src="https://github.com/user-attachments/assets/bc4de423-33b8-4dd3-9d22-2313edca2dac" />

# 『The challenge』

We were give container that can spawn a website to file upload our image and checking metadata. Here is the website:

<img width="1341" height="654" alt="image" src="https://github.com/user-attachments/assets/2fe70f1d-2dcf-4354-887d-78af8f90e7fb" />

So this is vulnerability of file upload, let solve!

# 『Solving Challenge』
> Solve by: Lylera_

First of all, this is upload file vulnerability. You can send an image through here. but you can upload .php file like usual on my previous challenge (trickster). So try to up an image first :

<img width="1339" height="825" alt="image" src="https://github.com/user-attachments/assets/dcb40fcc-ffed-4104-9db0-35f3a361083a" />

I upload this character (linne) image to checking where will gonna work. so lets try.

<img width="900" height="530" alt="image" src="https://github.com/user-attachments/assets/57fed6a1-ee41-4774-9b92-04397cee5d93" />

As you can see, this is most likely work as `exiftool` which can see a metadata of the image.

# 『The issue』

So the issue is no some folder where i can upload and see the image. only checking metadata. You can not set like `<image>.php` using burp. i wonder where gonna be work.

# 『Solution』

i start searching this vulnerability where almost same as `exiftool` happen and i found cve 2021. So my assumption is this challenge is cve 2021 was and this is my first time i face it. Which one cve? [cve 2021 exiftool](https://nvd.nist.gov/vuln/detail/cve-2021-22204)

And there is a github where a sc can be used to craft our payload. [Unicord](https://github.com/UNICORDev/exploit-CVE-2021-22204).

You can use this one to craft an image and rce. 

# 『Flag』

By knowing this vulnerability and know the issue (cve 2021), lets solve this one. First of all, i use comment `head /etc/passwd`. Here the result:

<img width="891" height="838" alt="image" src="https://github.com/user-attachments/assets/61e35f3e-56d4-4772-a6dc-857ebaa5e9b4" />

Then i try read the code how this payload work, and found something `(metadata "\c${system('head /etc/passwd')};")`

So by knowing the code, we can use it like `ls` without `head` on first place. like this:

<img width="513" height="38" alt="image" src="https://github.com/user-attachments/assets/2d10e15f-e2db-4154-8b53-4500e97cd4c7" />

The result:

<img width="890" height="613" alt="image" src="https://github.com/user-attachments/assets/6fda3f87-0fd2-4f07-b560-c1f42340b8d0" />

One step final. use command: `cat flag.txt` and here the result:

<img width="903" height="554" alt="image" src="https://github.com/user-attachments/assets/20b7d137-7cfc-4eaf-8849-5e1a5af42dd6" />

```
Flag: MetaCTF{exif_to0l_versi0n_c4n_kill_you}
```
