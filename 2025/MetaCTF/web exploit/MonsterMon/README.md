# 『MonsterMon』

<img width="1384" height="314" alt="image" src="https://github.com/user-attachments/assets/2f1a0b78-6bd2-4cab-a9da-ce8fc9d3fd75" />

# 『Source code』

[monstermon.go]()

[script.js]()

[data.json]()

# 『The challenge』

We were given a container that can spawn a webste. Here the website.

<img width="1919" height="911" alt="image" src="https://github.com/user-attachments/assets/3aadd314-419a-43cb-a30f-a73dc4eaf283" />

As you can see, this is some of trading card that very fun to solve it. So lets give it try.

# 『Solving challenge』
> Solve by: Lylera_

So this challenge will gonna be race condition idor bug where we can trade and change our card to another user card. why i would think that? Here is the code:

```
func thinkAboutTrade(u *user) {
	semaphore++
	temp := ctf_user.Card
	ctf_user.Card = u.Card
	u.Card = temp
	fmt.Println("Thinking.......")
	time.Sleep(10 * time.Second)
	fmt.Println("Nevermind!")
	temp = ctf_user.Card
	ctf_user.Card = u.Card
	u.Card = temp
	semaphore--
}
```

So this is almost same as pointer work where i mention about. So card 1 trade to card 2 and trade back to card 1. The result? will gonna be card 2. 

# 『The issue』

So if you think this is gonna be easy and will say `"oh, i just change it to one of the card that has flag"`, right? well yes if you have a logic that. But the problem is each card has a value. If you `/inspect`, you will see our value card. Here is the value:

<img width="370" height="115" alt="image" src="https://github.com/user-attachments/assets/9b599abf-ed63-4816-87a7-ac312d978ba0" />

and you can see on the code (source code) on line this:

```
func tradeCards(c *gin.Context) {
	username := c.Param("user")
	u := findUserByName(username)
	if u == nil {
		c.IndentedJSON(http.StatusAccepted, gin.H{"message": "user not found"})
		return
	}
	if u.Card.Value-ctf_user.Card.Value < 25 {
		go thinkAboutTrade(u)
		c.IndentedJSON(http.StatusAccepted, gin.H{"message": "Trade Processing"})
		return
	}
	c.IndentedJSON(http.StatusAccepted, gin.H{"message": "Trade Auto Rejected!!"})
}
```

if the value (which mean diff value) < 25, you can use this bug to get that trade card you want. So each card has a value, you can see on source section `data.json`. 

# 『Conclusion』

By having this conclusion, we can conclude that we can use this bug to abuse it. So the solver is:

step 1: trade to another user first that have diff value < 25. Like this:

<img width="1168" height="208" alt="image" src="https://github.com/user-attachments/assets/de59ad23-9137-427f-878d-828f0a8f17f9" />

Btw, i use burp suite to make it easy where i can use repeater to get dif. Or you can use many tab to get dif and card trade each user. like this:

<img width="1700" height="61" alt="Screenshot 2025-10-26 114725" src="https://github.com/user-attachments/assets/16b73f1c-43a7-40fc-8144-37eaf6516805" />

Why this is matter? race condition bro.

If user have diff value < 25, step 2: trade - check diff first before we exploit the bug. Like this

<img width="1919" height="915" alt="image" src="https://github.com/user-attachments/assets/558afd36-04c4-457d-9147-6a9a03ec5709" />

<img width="642" height="222" alt="image" src="https://github.com/user-attachments/assets/ece96f75-5877-4827-b954-21525ca41eac" />

If it minus, the trade successfull but will return to rejected. like this:

<img width="1919" height="919" alt="image" src="https://github.com/user-attachments/assets/1b160a33-d81b-4fd1-8ab7-d7de94843e91" />

If you figure it out, you will get the card that we trade early. Like this:

<img width="1041" height="156" alt="image" src="https://github.com/user-attachments/assets/74761196-82d5-4085-9435-fe4a0041f1ab" />

Trade to `ShadowNinja92` then trade to `ZappyZoomer` quickly to gain `ShadowNinja92` card. 

# 『The flag』

Once you reach this card:

<img width="1044" height="249" alt="image" src="https://github.com/user-attachments/assets/af7a71d0-7c7e-4b27-81f1-629b6d0a4044" />

Oh i almost forgot one thing. if in early trade `Shadowninja92` and `zappyzoomer` to get `shadowninja92` card, you use this cycle: `zappyzoomer - shadowninja92` to get `zappyzoomer` card. Repeat this cycle.

You can use my cycle if you want.

If you do it, you will get this:

<img width="524" height="216" alt="image" src="https://github.com/user-attachments/assets/be24c962-057e-405c-8b5c-ccd07e2ecd66" />

```
Flag: MetaCTF{r4p1d_c4rd_3xch4ng3}
```
