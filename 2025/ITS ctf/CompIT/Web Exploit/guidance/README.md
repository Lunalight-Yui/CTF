# 『guidance』
> Can you find a way to enter that path? or do you need guidance?

> Flag file in /flag.txt

Author: anarchistx

# 『The challenge』

We were given file name `main.go` and here the code file:
```
package main

import (
	"embed"
	"fmt"
	"io"
	"io/fs"
	"log"
	"math/rand"
	"net/http"
	"os"
	"path/filepath"
	"time"
)


//go:embed public/*
var webFS embed.FS

func apiClock(w http.ResponseWriter, r *http.Request) {
	io.WriteString(w, fmt.Sprintf(`{"ts":%d}`, time.Now().Unix()))
}

func staticHandler(w http.ResponseWriter, r *http.Request) {
	rawPath := r.URL.EscapedPath()


	if rawPath == "/" {
		data, _ := webFS.ReadFile("public/index.html")
		w.Header().Set("Content-Type", "text/html; charset=utf-8")
		w.Write(data)
		return
	}


	p := "." + rawPath
	if _, err := os.Stat(p); err != nil {
		http.NotFound(w, r)
		return
	}

	f, err := os.Open(p)
	if err != nil {
		http.NotFound(w, r)
		return
	}
	defer f.Close()

	fi, err := f.Stat()
	if err != nil {
		http.NotFound(w, r)
		return
	}

	http.ServeContent(w, r, filepath.Base(p), fi.ModTime(), f)
}

func main() {
	rand.Seed(time.Now().UnixNano())

	mux := http.NewServeMux()
	mux.HandleFunc("/api/clock", apiClock)


	publicFS, err := fs.Sub(webFS, "public")
	if err != nil {
		log.Fatalf("Failed to create sub filesystem: %v", err)
	}


	fileServer := http.FileServer(http.FS(publicFS))
	mux.Handle("/static/", http.StripPrefix("/static/", fileServer))


	mux.HandleFunc("/", staticHandler)

	addr := ":80"
	log.Printf("Guidance server starting on %s", addr)
	if err := http.ListenAndServe(addr, mux); err != nil {
		log.Fatalf("listen: %v", err)
	}
}
```

And here the challenge:

<img width="1896" height="914" alt="image" src="https://github.com/user-attachments/assets/f96b1208-1c56-4fd6-a741-bd17103579b7" />

# 『Solving challenge』
> Solve by: Lylera

To solve this we must searching anything else like inspect. Lets try to inspect this one.

<img width="931" height="471" alt="image" src="https://github.com/user-attachments/assets/3b8c3ba0-3820-4ec2-b388-8700816b8925" />

So there are two files. Hemm, which one we must.

# 『The issue』

If we use `/love_guides.html` or `Guide me`, it will lead on this:

<img width="1054" height="912" alt="image" src="https://github.com/user-attachments/assets/43730ef4-73a3-43cd-9fa0-7e00dccb661d" />

If we go to `/api/clock`, it will lead to this:

<img width="611" height="235" alt="image" src="https://github.com/user-attachments/assets/1426b851-dde3-4c33-b0a2-2708247b3627" />

But how to solve this one??

# 『The real solve』

If you know, you need `burp suite` to use this challenge. as you can see on source code, we can `path traversal` on another way. if you look carefully on this source code file, the name file is `main.go` which mean is golang language.

You can read this [one](https://go.dev/src/net/http/method.go) to understood of golang can use html methods. By using `connect`, you can path traversal. 

# 『Flag』

So you can use `intercept: on` or `send to repeater` to getting this flag. command: `CONNECT /../flag.txt`. Here the result:

<img width="1488" height="689" alt="image" src="https://github.com/user-attachments/assets/08ce5a04-db01-4aa5-829f-b131498957e9" />

```
Flag:compit{0nly_ur_h4nds_th4t_c4n_gu1d3_m3_thr0ugh_th1s_cru3l_j0urn3y_th4ts_full_0f_f4ls3_p4th5_4nd_r3r0ut3s}
```
