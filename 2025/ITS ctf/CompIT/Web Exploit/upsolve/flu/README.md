# 『flu』
> Its not like what you think bruh

Author: anarchistx

# 『The challenge』

We were given this challenge:

<img width="1919" height="914" alt="image" src="https://github.com/user-attachments/assets/0c733caf-a976-4bb5-8d6a-97f2f0c88987" />

So, it should be `file upload vulnerability`. So lets solve.

# 『Solving challenge』
> Solve by: Lylera_

How to solve this challenge? well, there are many wayss to solve this. But first, lets detect before we execute this vulnerability. Lets upload an image file (png).

<img width="591" height="196" alt="image" src="https://github.com/user-attachments/assets/acb53dba-de22-4225-b1f8-90463ed073e0" />

As you can see, this is success full. And lets open the burp to see what will gonna be to uploads.

<img width="1082" height="793" alt="image" src="https://github.com/user-attachments/assets/4f5c679b-cc04-4777-aef7-ca89cba4c556" />

Well then, seems nothing suspicious. Alright lets upload `php` file this time. here the result:

<img width="849" height="110" alt="image" src="https://github.com/user-attachments/assets/5cbb2456-2a2b-4e49-9ecd-ec03adbb4355" />

<img width="985" height="461" alt="image" src="https://github.com/user-attachments/assets/1c6e5fd3-a995-473e-9599-f4c724bacc2e" />

As you can see, this file cannot be received from this website.

# 『The issue』

So, the issue in this challenge is have any blacklist. It should be `.php` and checking for content.

If you know, you would probably know that this challenge is almost same as picoctf. Which one? [trickster](https://play.picoctf.org/practice/challenge/445?category=1&page=2). If you want to try, you can try. This is good knowledge for newbie.

In this case, it has some filter that filtering the content to cannot be upload.

Also, if you notice and want to do something, you can change your `filename: "<filename>.<extension>` to `filename: " "`. Don't believe me? Check this one:

<img width="1454" height="200" alt="image" src="https://github.com/user-attachments/assets/6d22b33f-f621-4263-8584-32fb88b81631" />

It will show where `upload.php` file name was placed.

# 『The real solve』

well, there are many ways to solve this challenge as i mention on early. You can change `header` file to bypass this. For example: `hexedit` which will change hex code.

Remember for the `image` file that successfull upload to this website? we will use it again and have some techniques. Here for the step to solve:

First:

<img width="370" height="129" alt="image" src="https://github.com/user-attachments/assets/251d13a4-ffe8-4283-a3c1-2ab6ca5bd4a4" />

Second:

<img width="614" height="358" alt="image" src="https://github.com/user-attachments/assets/3b01e476-700a-401c-881b-0bac8d3d7cfd" />

This is same as the number one.

Third:

<img width="613" height="367" alt="image" src="https://github.com/user-attachments/assets/c594be97-713b-4bca-925a-9cbb7006d831" />

Change your file name to `<filename>.php` and command an injection like this:

```
<?php echo system('ls');?>
```

It will allow you to see any file in there. Here the result:

<img width="1435" height="738" alt="image" src="https://github.com/user-attachments/assets/1167851b-ec39-47f5-af9e-9fbd78c19125" />

# 『Flag』

And the last step, search name: `getflag.php` and here the result:

<img width="646" height="154" alt="image" src="https://github.com/user-attachments/assets/bbe8f2d4-a0d0-4485-86c9-a56a5691a437" />

```
Flag: compit{N1ce_byp455_f0r_th3_F1l3Upl0adz}
```
