# Guidance
> Can you find a way to enter that path? or do you need guidance?

> Flag file in /flag.txt

Hint:
> Do you know how many HTTP methods that are supported in GoLang?

> Does the Source Code have any specific method handler?

Author: anarchistx

Solve: 

We're give link and source code. Here is source code:

```
package main

import (
	"embed"
	"fmt"
	"io"
	"io/fs"
	"log"
	"math/rand"
	"net/http"
	"os"
	"path/filepath"
	"time"
)


//go:embed public/*
var webFS embed.FS

func apiClock(w http.ResponseWriter, r *http.Request) {
	io.WriteString(w, fmt.Sprintf(`{"ts":%d}`, time.Now().Unix()))
}

func staticHandler(w http.ResponseWriter, r *http.Request) {
	rawPath := r.URL.EscapedPath()


	if rawPath == "/" {
		data, _ := webFS.ReadFile("public/index.html")
		w.Header().Set("Content-Type", "text/html; charset=utf-8")
		w.Write(data)
		return
	}


	p := "." + rawPath
	if _, err := os.Stat(p); err != nil {
		http.NotFound(w, r)
		return
	}

	f, err := os.Open(p)
	if err != nil {
		http.NotFound(w, r)
		return
	}
	defer f.Close()

	fi, err := f.Stat()
	if err != nil {
		http.NotFound(w, r)
		return
	}

	http.ServeContent(w, r, filepath.Base(p), fi.ModTime(), f)
}

func main() {
	rand.Seed(time.Now().UnixNano())

	mux := http.NewServeMux()
	mux.HandleFunc("/api/clock", apiClock)


	publicFS, err := fs.Sub(webFS, "public")
	if err != nil {
		log.Fatalf("Failed to create sub filesystem: %v", err)
	}


	fileServer := http.FileServer(http.FS(publicFS))
	mux.Handle("/static/", http.StripPrefix("/static/", fileServer))


	mux.HandleFunc("/", staticHandler)

	addr := ":80"
	log.Printf("Guidance server starting on %s", addr)
	if err := http.ListenAndServe(addr, mux); err != nil {
		log.Fatalf("listen: %v", err)
	}
}
```

Here the website:

<img width="1894" height="910" alt="image" src="https://github.com/user-attachments/assets/3e2da0a8-2007-40c0-915c-b8db2c9ed0b8" />

if we click the `Guide Me`, here the result:

<img width="1895" height="911" alt="image" src="https://github.com/user-attachments/assets/4abcb9b7-18cd-4e05-b00a-f0ffcbe50086" />

Simple right? BUt this was fake flag. SO if you submit, you will not get point.

I'll show you how to get the real one. here's the way to get real flag. If you know how to get HTTP methods, there are many ways. 

<img width="558" height="332" alt="image" src="https://github.com/user-attachments/assets/4c139761-ae5b-4127-8542-1f22fa0f4279" />

If you know, you can change `GET` to another way like `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`, `CONNECT`. If you want,
you can read this link: https://go.dev/src/net/http/method.go

So lets use `Burp Suite` to solve this challenge. This is path traversal using burp suite.

If you want to change `GET /` to another way like POST, you can `send to repeater` or intercept on and change it. You can choose anything you want.

So lets goo.

<img width="1469" height="409" alt="image" src="https://github.com/user-attachments/assets/88dbed5d-4ec8-4e56-a9ab-34914558a7d8" />

Here the result (if you use intercept: on)

<img width="1420" height="329" alt="image" src="https://github.com/user-attachments/assets/5d78a892-82b6-4744-8419-95aaedf148ad" />

Change `GET` to `CONNECT` to get this flag. Why? `CONNECT` can be used to establish a tunnel to the server identified by the target resource.

So by change `GET` to `CONNECT`, we can find `/flag.txt`. So here the result

<img width="1415" height="126" alt="image" src="https://github.com/user-attachments/assets/011e8a93-29aa-4d0e-b6c9-307fd4245c4c" />

<img width="1107" height="482" alt="image" src="https://github.com/user-attachments/assets/94bb8e15-5ad7-4de8-973c-d80f01ea9840" />

This is the real flag. Hehe- Sorry for fake flag.

```
Flag: HCS{0nly_ur_h4nds_th4t_c4n_gu1d3_m3_thr0ugh_th1s_cru3l_j0urn3y_th4ts_full_0f_f4ls3_p4th5_4nd_r3r0ut3s_221cf3ef-ae6b-468b-9e83-c30710b1f564}
```




